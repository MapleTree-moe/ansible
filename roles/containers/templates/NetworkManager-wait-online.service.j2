### {{ ansible_managed }} - {{ ansible_fqdn }}
###
### mapletree.moe - user service to detect network activation
### https://www.freedesktop.org/software/systemd/man/latest/systemd.service.html
###
### commit: {{ lookup('pipe', 'git rev-parse --short HEAD') }}

# UPGRADE: This isn't needed as of Podman 5.3.0, remove when it drops in RHEL

[Unit]
Description=Network Manager Wait Online for Users
Documentation=man:NetworkManager-wait-online.service(8)
Documentation=https://access.redhat.com/solutions/7004860
Documentation=https://github.com/containers/podman/issues/22197
Requires=NetworkManager.service
After=NetworkManager.service
Before=network-online.target

[Service]
Type=oneshot
ExecStart=/usr/bin/nm-online -q
RemainAfterExit=yes

Environment=NM_ONLINE_TIMEOUT=60

[Install]
WantedBy=network-online.target
